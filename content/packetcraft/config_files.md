---
title: "Config Files"
author: Ross Jacobs
date: 2019-08-06
description: Locations and formats of the files Wireshark uses

summary: 'Wireshark [Configuration Files](https://www.wireshark.org/docs/wsug_html_chunked/ChAppFilesConfigurationSection.html) | [Preferences](https://www.wireshark.org/docs/wsug_html_chunked/ChCustPreferencesSection.html)'
weight: 99
draft: false
---

## Editing Config Files

Each of these files consist of lines of data delimited with newlines, like a hosts file. A line is a comment if it starts with `#`.

### Config File List

Anything with [name] in it can have alphanumeric characters (`\w`).

| Name            | Description                                    | R/W*| Format          | Example Line |
|-----------------|------------------------------------------------|-----|-----------------|--------------|
| preferences     | Wireshark Settings                             | RW  | variable: value | `frame.generate_epoch_time: TRUE` |
| recent          | Recent GUI settings                            | RW  | variable: value | `gui.toolbar_main_show: TRUE` |
| cfilters        | Capture filters                                | RW  | "filter name" filter string | `"cf ARP" ether proto 0x0806` |
| dfilters        | Display filters                                | RW  | "filter name" filter string | `"df ARP" eth.type == 0x0806` |
| colorfilters    | Coloring rules                                 | RW  | @filter name@filter string<br>@[RGB bg color][RGB fg color] | `@tcp@tcp@[40555,49091,65534][0,0,0]` |
| disabled_protos | Disabled protocols                             | RW  | [protocol] | `tcp` |
| ethers          | Ethernet name resolution                       |  R  | [MAC address, :-. delmiter]  "Description" | `ff-ff-ff-ff-ff-ff  Broadcast` |
| manuf           | OUI name resolution                            |  R  | [OUI, :-. delmiter] "Manufacturer" | `00:00:01    Xerox` |
| hosts           | IPv4/IPv6 name resolution                      |  R  | [IPv4/IPv6 address] [name] | `192.168.0.1  homeserver` |
| services        | Network services                               |  R  | [name] | `mydns  5045/udp` |
| subnets         | IPv4 subnet name resolution                    |  R  | [IPv4 network adress]/[CIDR] [subnet name] | `192.168.0.0/24  ws_test_network` |
| ipxnets         | IPX name resolution                            |  R  | [IPX network number] [host name] | `C0.A8.2C.00  HR` |
| vlans           | VLAN ID name resolution                        |  R  | [VLAN ID] [VLAN name] | `123  Server-LAN` |
| ss7pcs          | SS7 point code resolution                      |  R  | [SS7 point code] [SS7 node name] | `2-1234  MyPointCode1` |

\* Wireshark reads this file/writes to this file.

<i>Most of this table is lifted directly from [Configuration Profiles](https://www.wireshark.org/docs/wsug_html_chunked/ChAppFilesConfigurationSection.html).</i>

#### Example Files

These files are from the Wireshark Repo or my system.

* [cfilters](https://raw.githubusercontent.com/wireshark/wireshark/master/cfilters)
* [colorfilters](https://raw.githubusercontent.com/wireshark/wireshark/master/colorfilters)
* [dfilters](https://raw.githubusercontent.com/wireshark/wireshark/master/dfilters)
* [dfilter_macros](https://raw.githubusercontent.com/wireshark/wireshark/master/dfilter_macros)
* [disabled_protos](https://dl.dropboxusercontent.com/s/d97lgjqnzs5q9de/disabled_protos): Contains some gaming protocols that I'll never look at
* [ethers](https://dl.dropboxusercontent.com/s/sy07uj010bzl342/ethers)
* [hosts](https://dl.dropboxusercontent.com/s/3ghd7fwufzj07be/hosts): Hosts file from an install of Ubuntu 18.04
* [manuf](https://raw.githubusercontent.com/wireshark/wireshark/master/manuf)
* [preferences](https://dl.dropboxusercontent.com/s/7h4uqs97951y6an/preferences): Preferences file from Macos
* [recent](https://dl.dropboxusercontent.com/s/hwrieakon3ho0gr/recent): Recent GUI settings from Macos
* [services](https://raw.githubusercontent.com/wireshark/wireshark/master/services)

To be used with exercise in [Name Resolution](/analyze/add_context/name_resolution):

* [ipxnets](/files/ipxnets)
* [subnets](/files/subnets)
* [vlans](/files/vlans)

### Safety First

You may see this at the top of config files:

```sh
# DO NOT EDIT THIS FILE!  It was created by Ethereal
```

It might look scary, but editing config files is fine as long as you take precautions.

1. Before you start, copy your current config folder somewhere safe
2. Follow the format used by the examples
3. If you're unsure, use the syntax verifier below after saving to make sure files are still readable
4. Do not have Wireshark open while editing config files. Wireshark loads config files on startup, so if it's already open, it could overwrite your configs.

### Verifying Correct Syntax After Editing

You can use this script to verify that your preferences files have the correct syntax after editing them.
It will also print which config files are "extra" and "missing" per [documentation](https://www.wireshark.org/docs/wsug_html_chunked/ChAppFilesConfigurationSection.html).
Note that "missing" a documented config is not a bad thing. For example, you will probably never need or use an IPX name resolution file.

#### Verification Script

```python
"""Used in an example of how to check validity of wireshark config files"""
import re
import os


def gen_regexes():
    """Generate the regex dictionary."""
    ws = r'\s+'  # whitespace
    name = r'(?:[^\s]*)'
    # Comment is always optional
    comment = r'(?: *# ?.*)?'
    yaml_key = r'(?:[\s\S]+?)(?=>\n\S)'
    # Capture/Display Filter
    ws_filter = r'(?:[^@\n]+?)'
    # Colorfilter color consisting of 3 comma-separated values, 0-65535
    color = r'\[(?:\d{1,5}),(?:\d{1,5}),(?:\d{1,5})]'
    mac_addr = r'(?:[a-fA-F0-9]{2}[.:-]){5}[a-fA-F0-9]{2}'
    oui = r'(?:[a-fA-F0-9]{2}[.:-]){2}[a-fA-F0-9]{2}'
    ip_addr = r'(?:[\d\.]*|[\d:]*)'
    cidr = r'\/\d{1,3}'
    domain = r'[0-9A-Za-z.]+'
    service = r'\d+\/\S+'
    ipx = r'(?:[0-9A-Fa-f]{2}[:.-]){3}[a-fA-F0-9]{2}|[0-9A-Fa-f]{4}'
    vlan = r'(?:\d{1,4})'
    ss7 = r'(?:[0-9-]+)'

    # Don't start regex with newlines as Python's readline drops it.
    line_regexes = {
        "preferences": name + ': ?' + yaml_key,
        "recent": name + ws + ws_filter + comment,
        "cfilters": '"' + name + '"' + ws + ws_filter + comment,
        "dfilters": '"' + name + '"' + ws + ws_filter + comment,
        "colorfilters": '@' + name + '@' + ws_filter + '@' + color + color,
        "disabled_protos": name,
        "ethers": mac_addr + ws + name + comment,
        "manuf": oui + ws + name + comment,
        "hosts": ip_addr + ws + domain + comment,
        "services": domain + ws + service + comment,
        "subnets": ip_addr + cidr + ws + name + comment,
        "ipxnets": ipx + ws + name + comment,
        "vlans": vlan + ws + name + comment,
        "ss7pcs": ss7 + ws + name + comment
    }
    return line_regexes


def readfile(filename, f, line_regexes):
    """Read the file and output data based on it."""
    message = ""
    line_comment = r'(?:^|\n)#.*'
    line = f.readline()
    invalid_syntax = False
    count = 1
    while line:
        regex = '(' + line_comment + '|' + line_regexes[filename] + '|\n)'
        if not re.findall(regex, line):
            message += filename + ":  Invalid syntax found on line: `" \
                       + line + "` \nAt line num " + count + \
                       " using regex `" + regex + "`"
            invalid_syntax = True
        count += 1
        line = f.readline()
    if not invalid_syntax:
        message += filename + ": ✓"

    return message


def main():
    """Main func."""
    line_regexes = gen_regexes()

    files_not_found = []
    found_configs = []
    dir_files = os.listdir(".")
    if os.path.basename(os.getcwd()).lower() != "wireshark":
        print("Dir is not `wireshark`.\n"
              "Are you sure this is the wireshark config folder?")
    for filename in line_regexes.keys():
        if os.path.exists(filename):
            with open(filename) as f:
                file_message = readfile(filename, f, line_regexes)
                found_configs.append(file_message)
        else:
            files_not_found.append(filename)
        if filename in dir_files:
            dir_files.remove(filename)
    print("Found files:\n\t" + "\n\t".join(found_configs))
    print("\nExtra config files:\n\t" + "\n\t".join(dir_files))
    print("\nConfig files not found:\n\t" + "\n\t".join(files_not_found))


if __name__ == '__main__':
    main()

```

#### Example Output

```bash
Found files:
	preferences: ✓
	recent: ✓
	dfilters: ✓
	hosts: ✓

Extra config files:
	80211_keys
	.hosts.swp
	language
	decode_as_entries
	ssl_keys
	dfilter_macros
	dfilter_buttons
	recent_common

Config files not found:
	cfilters
	colorfilters
	disabled_protos
	ethers
	manuf
	services
	subnets
	ipxnets
	vlans
	ss7pcs
```

## Tshark Config Flags

For when you don't want to edit the defaults, tshark allow you to override config files or values inline:

* **-C preferences**: Use a different preferences file
* **-o key:value**: Override a specific setting in preferences
* **-H hosts**: Use a different hosts file

`tshark -G currentprefs` will print all of your current settings to stdout.

## Further Reading

* 2014-07-01, Roy Cheok, [Wireshark: A Guide to Color My Packets](https://www.sans.org/reading-room/whitepapers/detection/wireshark-guide-color-packets-35272)
